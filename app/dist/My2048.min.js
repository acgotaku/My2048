/*! My2048 - v0.0.0 - 2014-06-20 */
function showNumberWithAnimation(a,b,c){var d=$("#number-cell-"+a+"-"+b);d.css("background-color",support2048.getNumberBackgroundColor(c)),d.css("color",support2048.getNumberColor(c)),d.text(c),d.animate({width:"100px",height:"100px",top:support2048.getPosTop(a,b),left:support2048.getPosLeft(a,b)},50)}function showMoveAnimation(a,b,c,d){var e=$("#number-cell-"+a+"-"+b);e.animate({top:support2048.getPosTop(c,d),left:support2048.getPosLeft(c,d)},200)}var support2048={getPosTop:function(a){return 20+120*a},getPosLeft:function(a,b){return 20+120*b},getNumberBackgroundColor:function(a){switch(a){case 2:return"#eee4da";case 4:return"#ede0c8";case 8:return"#f2b179";case 16:return"#f59563";case 32:return"#f67c5f";case 64:return"#f65e3b";case 128:return"#edcf72";case 256:return"#edcc61";case 512:return"#9c0";case 1024:return"#33b5e5";case 2048:return"#09c";case 4096:return"#a6c";case 8192:return"#93c"}return"black"},getNumberColor:function(a){return 4>=a?"#776e65":"white"},nospace:function(a){for(var b=0;4>b;b++)for(var c=0;4>c;c++)if(0==a[b][c])return!1;return!0},canMoveLeft:function(){for(var a=0;4>a;a++)for(var b=1;4>b;b++)if(0!=board[a][b]&&(0==board[a][b-1]||board[a][b-1]==board[a][b]))return!0;return!1},canMoveRight:function(){for(var a=0;4>a;a++)for(var b=2;b>=0;b--)if(0!=board[a][b]&&(0==board[a][b+1]||board[a][b+1]==board[a][b]))return!0;return!1},canMoveUp:function(){for(var a=0;4>a;a++)for(var b=1;4>b;b++)if(0!=board[b][a]&&(0==board[b-1][a]||board[b-1][a]==board[b][a]))return!0;return!1},canMoveDown:function(){for(var a=0;4>a;a++)for(var b=2;b>=0;b--)if(0!=board[b][a]&&(0==board[b+1][a]||board[b+1][a]==board[b][a]))return!0;return!1},noBlockHorizontal:function(a,b,c,d){for(var e=b+1;c>e;e++)if(0!=d[a][e])return!1;return!0},noBlockVertical:function(a,b,c,d){for(var e=b+1;c>e;e++)if(0!=d[e][a])return!1;return!0},nomove:function(){return this.canMoveDown()||this.canMoveUp()||this.canMoveRight()||this.canMoveLeft()?!1:!0}},board=new Array,score=0;$(function(){var a={board:new Array,init:function(){for(var a=this,b=0;4>b;b++)for(var c=0;4>c;c++){var d=$("#grid-cell-"+b+"-"+c);d.css("top",support2048.getPosTop(b,c)),d.css("left",support2048.getPosLeft(b,c))}for(var b=0;4>b;b++){board[b]=new Array;for(var c=0;4>c;c++)board[b][c]=0}a.updateBoardView(),a.generateOneNumber(),a.generateOneNumber(),a.bindKey(),$("#start").click(function(){a.newGame()})},newGame:function(){for(var a=0;4>a;a++)for(var b=0;4>b;b++)board[a][b]=0;$(".game-message").removeClass("game-over"),this.updateBoardView(),this.generateOneNumber(),this.generateOneNumber()},updateBoardView:function(){$(".number-cell").remove();for(var a=0;4>a;a++)for(var b=0;4>b;b++){$("#grid-container").append('<div class="number-cell" id="number-cell-'+a+"-"+b+'"></div>');var c=$("#number-cell-"+a+"-"+b);0==board[a][b]?(c.css("width","0px"),c.css("height","0px"),c.css("top",support2048.getPosTop(a,b)+50),c.css("left",support2048.getPosLeft(a,b)+50)):(c.css("width","100px"),c.css("height","100px"),c.css("top",support2048.getPosTop(a,b)),c.css("left",support2048.getPosLeft(a,b)),c.css("background-color",support2048.getNumberBackgroundColor(board[a][b])),c.css("color",support2048.getNumberColor(board[a][b])),c.text(board[a][b]))}},generateOneNumber:function(){if(support2048.nospace(board))return!1;for(var a=parseInt(Math.floor(4*Math.random())),b=parseInt(Math.floor(4*Math.random())),c=0;4>c;c++)for(var d=0;4>d&&0!=board[a][b];d++)a=parseInt(Math.floor(4*Math.random())),b=parseInt(Math.floor(4*Math.random()));var e=Math.random()<.5?2:4;return board[a][b]=e,showNumberWithAnimation(a,b,e),!0},bindKey:function(){var a=this;$(document).keydown(function(b){switch(b.keyCode){case 37:a.moveLeft()&&(setTimeout(a.generateOneNumber.bind(a),210),setTimeout(a.isGameOver.bind(a),360));break;case 38:a.moveUp()&&(setTimeout(a.generateOneNumber.bind(a),210),setTimeout(a.isGameOver.bind(a),360));break;case 39:a.moveRight()&&(setTimeout(a.generateOneNumber.bind(a),210),setTimeout(a.isGameOver.bind(a),360));break;case 40:a.moveDown()&&(setTimeout(a.generateOneNumber.bind(a),210),setTimeout(a.isGameOver.bind(a),360))}})},moveLeft:function(){if(!support2048.canMoveLeft(board))return!1;for(var a=0;4>a;a++)for(var b=1;4>b;b++)if(0!=board[a][b])for(var c=0;b>c;c++)0==board[a][c]&&support2048.noBlockHorizontal(a,c,b,board)?(showMoveAnimation(a,b,a,c),board[a][c]=board[a][b],board[a][b]=0):board[a][c]==board[a][b]&&support2048.noBlockHorizontal(a,c,b,board)&&(showMoveAnimation(a,b,a,c),board[a][c]+=board[a][b],board[a][b]=0);return setTimeout(this.updateBoardView.bind(this),200),!0},moveRight:function(){if(!support2048.canMoveRight(board))return!1;for(var a=0;4>a;a++)for(var b=2;b>=0;b--)if(0!=board[a][b])for(var c=3;c>b;c--)0==board[a][c]&&support2048.noBlockHorizontal(a,c,b,board)?(showMoveAnimation(a,b,a,c),board[a][c]=board[a][b],board[a][b]=0):board[a][c]==board[a][b]&&support2048.noBlockHorizontal(a,c,b,board)&&(showMoveAnimation(a,b,a,c),board[a][c]+=board[a][b],board[a][b]=0);return setTimeout(this.updateBoardView.bind(this),200),!0},moveUp:function(){if(!support2048.canMoveUp(board))return!1;for(var a=0;4>a;a++)for(var b=1;4>b;b++)if(0!=board[b][a])for(var c=0;b>c;c++)0==board[c][a]&&support2048.noBlockVertical(a,c,b,board)?(showMoveAnimation(b,a,c,a),board[c][a]=board[b][a],board[b][a]=0):board[c][a]==board[b][a]&&support2048.noBlockVertical(a,c,b,board)&&(showMoveAnimation(b,a,c,a),board[c][a]*=2,board[b][a]=0);return setTimeout(this.updateBoardView.bind(this),200),!0},moveDown:function(){if(!support2048.canMoveDown(board))return!1;for(var a=0;4>a;a++)for(var b=2;b>=0;b--)if(0!=board[b][a])for(var c=3;c>b;c--)0==board[c][a]&&support2048.noBlockVertical(a,c,b,board)?(showMoveAnimation(b,a,c,a),board[c][a]=board[b][a],board[b][a]=0):board[c][a]==board[b][a]&&support2048.noBlockVertical(a,c,b,board)&&(showMoveAnimation(b,a,c,a),board[c][a]*=2,board[b][a]=0);return setTimeout(this.updateBoardView.bind(this),200),!0},isGameOver:function(){support2048.nomove(board)&&this.GameOver()},GameOver:function(){$(".game-message").hasClass("game-over")||$(".game-message").addClass("game-over")}};a.init()});